# Proposed Project Structure

```
llm-judge-chatbot/
│
├── README.md                          # Main project documentation
├── docker-compose.yml                 # Docker setup for easy deployment
│
├── docs/                              # All documentation
│   ├── planning/                      # Planning documents
│   │   ├── instructions.md           # Project overview and concept
│   │   ├── architecture.md           # Technical architecture details
│   │   ├── implementation-plan.md    # Step-by-step build plan
│   │   └── project-structure.md      # File structure documentation
│   │
│   ├── API.md                        # API documentation
│   ├── CRITERIA-GUIDE.md            # Guide for configuring criteria
│   ├── DEPLOYMENT.md                # Deployment instructions
│   └── examples/                     # Example configurations
│       ├── criteria-strict.yaml
│       ├── criteria-moderate.yaml
│       └── criteria-lenient.yaml
│
├── backend/                           # Python backend
│   ├── README.md                      # Backend-specific docs
│   ├── pyproject.toml                 # Python project config & dependencies (UV)
│   ├── uv.lock                        # Lock file generated by UV
│   ├── .python-version                # Python version specification
│   ├── .env.example                   # Example environment variables
│   ├── .env                          # Actual env vars (gitignored)
│   │
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py                   # FastAPI application entry point
│   │   ├── config.py                 # Configuration management
│   │   ├── models.py                 # Pydantic data models
│   │   │
│   │   ├── services/                 # Business logic layer
│   │   │   ├── __init__.py
│   │   │   ├── chatbot.py           # Chatbot service
│   │   │   ├── judge.py             # Judge service
│   │   │   ├── llm_adapter.py       # LLM provider abstraction
│   │   │   └── orchestrator.py      # Conversation flow control
│   │   │
│   │   ├── api/                      # API routes
│   │   │   ├── __init__.py
│   │   │   ├── chat.py              # Chat endpoints
│   │   │   ├── criteria.py          # Criteria management endpoints
│   │   │   └── websocket.py         # WebSocket handlers
│   │   │
│   │   └── utils/
│   │       ├── __init__.py
│   │       └── prompts.py           # Prompt templates
│   │
│   ├── config/                       # Configuration files
│   │   ├── criteria.yaml            # Judge criteria configuration
│   │   └── prompts.yaml             # Prompt templates (optional)
│   │
│   └── tests/                        # Backend tests
│       ├── __init__.py
│       ├── test_judge.py
│       ├── test_chatbot.py
│       └── test_orchestrator.py
│
├── frontend/                          # React + TypeScript frontend
│   ├── package.json
│   ├── package-lock.json
│   ├── tsconfig.json                 # TypeScript configuration
│   ├── vite.config.ts                # Vite build configuration
│   ├── index.html
│   │
│   ├── public/                       # Static assets
│   │   └── favicon.ico
│   │
│   └── src/
│       ├── main.tsx                  # Application entry point
│       ├── App.tsx                   # Main app component
│       ├── index.css                 # Global styles
│       │
│       ├── components/               # React components
│       │   ├── ChatUI.tsx           # Main chat interface
│       │   ├── JudgePanel.tsx       # Judge feedback display
│       │   ├── SettingsPanel.tsx    # Configuration UI
│       │   ├── Message.tsx          # Individual message component
│       │   ├── MessageList.tsx      # Message list container
│       │   ├── MessageInput.tsx     # Message input field
│       │   ├── ScoreDisplay.tsx     # Score visualization with traffic lights
│       │   ├── TrafficLight.tsx     # Traffic light indicator component
│       │   └── CriteriaCard.tsx     # Individual criterion display
│       │
│       ├── services/                 # Frontend services
│       │   ├── api.ts               # REST API client
│       │   └── websocket.ts         # WebSocket client
│       │
│       ├── types/                    # TypeScript type definitions
│       │   └── index.ts             # All interfaces and types
│       │
│       ├── hooks/                    # Custom React hooks
│       │   ├── useChat.ts           # Chat state management
│       │   ├── useWebSocket.ts      # WebSocket connection
│       │   └── useCriteria.ts       # Criteria management
│       │
│       └── utils/                    # Utility functions
│           ├── formatting.ts        # Text formatting helpers
│           └── constants.ts         # Constants and configs
│
## Key Files and Their Purposes

### Backend Core Files

#### `backend/app/main.py`
- FastAPI app initialization
- Middleware setup
- Route registration
- CORS configuration

#### `backend/app/config.py`
- Load criteria.yaml
- Environment variable management
- Configuration validation
- Hot-reload support

#### `backend/app/models.py`
- `Message` - Chat message model
- `JudgeEvaluation` - Evaluation result
- `Criterion` - Single criterion definition
- `ConversationState` - Conversation state tracking
- `WebSocketEvent` - WebSocket event types

#### `backend/app/services/llm_adapter.py`
- `BaseLLMAdapter` - Abstract interface
- `OpenAIAdapter` - OpenAI implementation
- `AnthropicAdapter` - Anthropic implementation
- `LocalAdapter` - Local model implementation (Ollama)

#### `backend/app/services/judge.py`
- Load and manage criteria
- Build evaluation prompts
- Call LLM for evaluation
- Parse and structure results
- Calculate weighted scores

#### `backend/app/services/chatbot.py`
- Manage conversation context
- Build chatbot prompts
- Generate responses
- Handle refinement with judge feedback
- Support streaming responses

#### `backend/app/services/orchestrator.py`
- Implement conversation flows
- Coordinate chatbot and judge
- Manage iteration loops
- Apply thresholds and decisions
- Handle errors and fallbacks

### Frontend Core Files

#### `frontend/src/App.tsx`
- Main application layout
- Route management
- Global state (if using Context)

#### `frontend/src/components/ChatUI.tsx`
- Complete chat interface
- Message list
- Input field
- Send functionality
- Loading states

#### `frontend/src/components/JudgePanel.tsx`
- Display judge evaluation
- Show scores (overall + per criterion)
- Display feedback text
- Iteration history
- Visual indicators

#### `frontend/src/components/SettingsPanel.tsx`
- Criteria configuration UI
- Feature toggles
- Profile selection
- Save/reset functionality

#### `frontend/src/services/websocket.ts`
- WebSocket connection management
- Event emitters and listeners
- Reconnection logic
- Error handling

#### `frontend/src/types/index.ts`
- TypeScript interfaces matching backend models
- Ensures type safety across application

### Configuration Files

#### `backend/config/criteria.yaml`
- Define all judge criteria
- Set weights and thresholds
- Configure profiles (strict/moderate/lenient)
- Enable/disable features

#### `.env` (backend)
```bash
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
LLM_PROVIDER=openai  # or anthropic, local
CHATBOT_MODEL=gpt-4
JUDGE_MODEL=gpt-4
MAX_REFINEMENT_ITERATIONS=2
ENABLE_INPUT_CRITIQUE=true
ENABLE_FEEDBACK_LOOP=true
```

#### `docker-compose.yml`
- Backend service (Python)
- Frontend service (Node + Vite)
- Environment configuration
- Port mappings

## File Size Estimates

- Small files (< 100 lines): `config.py`, `prompts.py`, most components
- Medium files (100-300 lines): `judge.py`, `chatbot.py`, `orchestrator.py`, `ChatUI.tsx`
- Large files (300+ lines): `main.py`, `websocket.py` (only if very complex)

## Development Workflow

1. Start with backend foundation (Phase 1-3)
2. Test services independently with simple scripts
3. Add API layer and test with curl/Postman
4. Build frontend components
5. Integrate frontend with backend
6. Test complete flows
7. Polish and optimize

## Next Actions

This structure will be created during implementation. Ready to proceed when you approve!
